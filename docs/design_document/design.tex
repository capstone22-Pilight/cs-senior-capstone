\documentclass[oneside,openright]{book}
\usepackage{listings}
\usepackage{underscore}
\usepackage[bookmarks=true]{hyperref}
\usepackage{atbegshi}% http://ctan.org/pkg/atbegshi
\AtBeginDocument{\AtBeginShipoutNext{\AtBeginShipoutDiscard}}
\renewcommand\thesection{\arabic{section}}
\hypersetup{
    bookmarks=false, % show bookmarks bar?
    pdftitle={Software Requirement Specification}, % title
    pdfauthor={Malcom Diller, Evan Steele, Sean Rettig}, % author
    pdfsubject={Raspberry Pi Outdoor Lighting}, % subject of the document
    pdfkeywords={TeX, LaTeX, graphics, images}, % list of keywords
    colorlinks=true, % false: boxed links; true: colored links
    linkcolor=blue, % color of internal links
    citecolor=black, % color of links to bibliography
    filecolor=black, % color of file links
    urlcolor=blue, % color of external links
    %linktoc=page % only page is linked
}
\def\myversion{1.0 }
\title{
	\flushright
		\rule{16cm}{5pt}\vskip1cm
		\Huge{DESIGN DOCUMENT}\\
	for\\
		\vspace{2cm}
	Not Exactly the Internet of Things for Outdoor Lighting\\
		\vspace{2cm}
	\LARGE{Conceptual Release:}
	\vspace{2cm}
	\LARGE{Subject to change\\}
	\vspace{2cm}
	Malcolm Diller, Sean Rettig, and Evan Steele\\
        Client: Victor Hsu\\
        OSU CS Senior Capstone Group 22
		\vfill
		\rule{16cm}{5pt}
}

\date{}
\usepackage{hyperref}
\begin{document}
\pagenumbering{gobble} 
\maketitle
\tableofcontents
\newpage
\pagenumbering{arabic} 
\section{Introduction}

In the twenty-first century, your home should be smart and responsive. An
automated home should be able to control appliances such as lights through
single-board computer units that have Internet connectivity. Many commercial
options exist, such as those from Nest Labs, but such devices are prohibitively
expensive for most consumers, especially for simple tasks such as lighting
automation. This project aims to provide an low-cost alternative for simple
home automation, for devices like lights and garage door openers. Using a
low-cost embedded computer such as the Raspberry Pi and cheap wireless
communication modules such as the ESP8266, this project will provide a cheap,
easy-to-install home automation system.

The project is called "Not Exactly the Internet-of-Things" because it's not
designed as a typical IoT product. The network is entirely local, not worrying
about an external connection to the Wide Area Network. Some additional
components such as consulting an external API could be considered, but that's
an addon to the finished product. As it is made as a home application, it is
readily accessible through smartphones and web interfaces. With a clean user
interface that enables both manual control and automation profiles, the
application will require a minimal learning curve and be simple to set up.  

\section{Overview}

We will be using a wide variety of open source technologies and inexpensive
hardware to provide a low-cost home automation system. We will be using a
varied set of tools to accomplish our goal, including these tools:

\begin{enumerate}
    \item The Yocto Project 
    \begin{enumerate}
        \item The Yocto Project is a kernel building system designed for
            embedded systems. It easily incorporates additional features and
            custom packages directly from Git repositories. It makes it easy to
            build a customized image with only exactly what we want and no
            unnecessary packages. It also allows us to customize elements of
            the kernel such as startup scripts in init.d, kernel modules and
            network scripts. The kernel will be compiled for the Raspberry Pi
            and copied to an SD card using Yocto's filesystem script.
    \end{enumerate} 
        \item Raspberry Pi 2
    \begin{enumerate}
        \item The Raspberry Pi 2 is an ARMv7 processor based microcomputer
            designed for educational and embedded projects. We will use it as a
            low-cost server solution for the Lighting project. It can serve as
            the web server running NGINX and transmit TCP commands to the
            ESP8266 wifi modules. The Pi will be outfitted witha 320x280 TFTLCD
            display so that the interface for control can be accessed directly.
            The Pi will also run a DHCP server to distribute IP addresses to
            the modules.
    \end{enumerate} 
        \item ESP8266
    \begin{enumerate}
        \item The ESP8266 is a self-contained SoC that provides Wi-Fi
            functionality to a device. Our module is outfitted with custom
            firmware, written in Lua and flashed to the device using the
            Arduino IDE, that allows the module to autoconnect to the Raspberry
            Pi acting as a WAP. The board we have is designed to connect to an
            electronic relay using jumper cables. Using simple TCP commands,
            the board will flip the relay pins on and off.
    \end{enumerate}
\end{enumerate}

\section{Project Scope and Product Features}

The aim of this project is to create a home automation system that is cheap,
wireless, and easy to use. The user of this product should expect to be able to
use the following features of our device:

\begin{enumerate}
    \item Lights and Groups
    \begin{enumerate}
        \item The lights can be controlled from a phone or from the built-in
            touchscreen
        \item Lights can be put into "groups" so that they can be controlled
            all at once
        \item Groups can also be nested into other groups to create hierarchies
            of lights, in order to control an even larger scope.
        \item The user will be able to add groups of lights to the system under
            a nickname.
        \item Lights and groups of lights will be displayed as a list.
        \item A slider will be used to adjust the intensity of each light.
    \end{enumerate}
    \item Rules / Types of Control
    \begin{enumerate}
        \item Lights can be toggled on and off manually, but they can also be
            set to be activated on a specific schedule
        \item Rules can be set for lights or groups of lights
        \item There are 6 main types of schedules that Rules can trigger on
        \begin{enumerate}
            \item Time of Day (e.g. “turn on at 8pm and turn off at 6am”) 
            \item Day of Week  (e.g. “turn on during Wednesdays”)
            \item Day of Month  (e.g. “turn on every 1st of the month”)
            \item Day of Year  (e.g. “turn on every January 1st”)
            \item Specific Dates  (e.g. “turn on from Dec. 24th at 2am to Dec
                27th at 8pm”)
            \item Sunrise / Sunset (e.g "turn on when the sun sets, turn off
                when the sun rises")
        \end{enumerate}
        \item Multiple rules can be applied to each light or group of lights by
            using AND or OR
        \item Lights can be toggled based on the toggle state of its parent
            group
        \item Rules can be enabled or disabled
        \item Lights or groups can be set to gradually dim/brighten over a set
            period of time instead of toggling
    \end{enumerate}
    \item Stretch Goals
    \begin{enumerate}
        \item The system can control devices other than just lights:
        \begin{enumerate}
            \item Garage door openers
            \item Music players
            \item Holiday decorations
            \item Sprinkler systems
        \end{enumerate}
        \item The web interface is accessible over the Internet (Instead of
            only on the local network)
        \begin{enumerate}
            \item The interface is accessible for only the homeowner or
                authorized individuals
            \item The interface hosted on a remote server if the user does not
                want to deal with port forwarding their home network.
        \end{enumerate}
        \item Additional types of triggers for rules
        \begin{enumerate}
            \item Weather conditions (e.g. lights can turn on automatically if
                it starts raining)
            \item Toggled based off of a schedule in a google calendar
            \item Moon position or other celestial data (e.g. lights could turn
                off during a full moon or solar eclipse for better viewing)
            \item Motion sensors (e.g. lights turn on when someone walks up to
                the front door
            \item Light sensors (e.g. lights turn off at a certain brightness
                level)
            \item Moisture sensors (e.g. lights turn on when its wet outside)
            \item Sound sensors (e.g. lights turn on after a loud noise, or
                strobe to the beat of music that is playing)
        \end{enumerate}
    \end{enumerate}
\end{enumerate}

\section{Product Perspective}

The final deliverable of a commercial version of this product would likely
include the following:

\begin{itemize}
    \item A central control unit consisting of the Raspberry Pi, its power
        cable, the touchscreen module, a case, and an SD card with the server
        software preloaded onto it.
    \item One or more plug units which would likely resemble a power strip,
        with each plug being individually controllable by the system.
\end{itemize}

To set up the system, the user simply plugs both the control unit and the plug
unit(s) into wall power.  The plug units will preconfigured to connect to the
control unit.  The user can then plug devices into the plug units, such as
lamps, and the display on the control unit will update itself automatically
with a list of lights.  The lights can have either numbered (e.g. "Zone 1,
Light 1") or randomized but memorable names by default (e.g. "Blue Koala")
which can be later edited through the web interface.  To access the web
interface, the user connects to the wifi network provided by the control unit
using the credentials included with the manual, or perhaps printed on the
control unit itself.  They then open a web browser and connect to a specific
URL, provided to the user with the wifi password.  From the web interface, all
features are accessble, such as renaming lights, creating light groups, and
applying rules for when to toggle lights.

\section{Testing}

To test the functionality and correctness of our system, we will test the
various components both individually and when integrated with other components:

\begin{itemize}
    \item We plan to test the wireless communication capabilities of the system
        by attempting to send packets between the control unit and plug units
        at varying distances and in varying environments, including open and
        walled areas.  Ideally, the range should be great enough to fully cover
        the average American house/apartment.  Once this is complete, it will
        likely not need to be changed or extended much, reducing the need for
        regression testing.
    \item We plan to test the actual light toggling (as performed by the plug
        units) manually.  Once this is complete, it will likely not need to be
        changed or extended much, reducing the need for regression testing.
    \item We plan to test the functionality of the touchscreen interface
        through manual human interaction testing.  Once this is complete, it
        will likely not need to be changed or extended much, reducing the need
        for regression testing.
    \item We plan to test the functionality of the web interface through a
        combination of manual human interaction testing, automated API-driven
        testing, and automated GUI testing (using a platform such as Selenium).
        The plug units can send back acknowledgement packets to confirm what
        actions they took in response to the tests, allowing nearly complete
        integration tests to be performed automatically when changes are made
        to the control program and web interface.  These automated tests will
        help prevent regressions as new features are developed and save time in
        ensuring the correctness of the system.
\end{itemize}

\section{Timeline}
\begin{tabular}{ | l | l | }
   \hline
   \textbf{Device control} & \textbf{Due Date} \\ \hline

   Server can boot with GUI and touchscreen support & Thu 11/19/15 \\ \hline
   Server starts control program on power on & Mon 11/23/15 \\ \hline
   Clients are loaded with client control program & Thu 11/12/15 \\ \hline
   Clients discover connected relays/lights & Thu 11/19/15 \\ \hline
   Clients can toggle lights individually & Tue 11/24/15 \\ \hline
   Lights can be toggled over time & Fri 11/27/15 \\ \hline
   Server acts as wireless access point for clients & Mon 11/30/15 \\ \hline
   Clients can be paired with servers & Fri 12/4/15 \\ \hline
   Clients tell server which lights are available & Tue 12/8/15 \\ \hline
   Server can send light instructions to clients & Thu 12/10/15 \\ \hline
   Clients can receive light instructions from server & Mon 12/14/15 \\ \hline
   Clients can perform light instructions from server & Wed 12/16/15 \\ \hline
   
   \textbf{User Interface} & \\ \hline
   
   Server serves web site with control interface for user & Mon 11/30/15 \\ \hline
   Accessible via the system’s built-in touchscreen & Mon 12/7/15 \\ \hline
   Accessible to other devices like phones & Thu 12/3/15 \\ \hline
   Displays list of connected clients & Mon 12/7/15 \\ \hline
   Can nickname clients & Tue 12/8/15 \\ \hline
   Displays list of connected lights & Wed 12/9/15 \\ \hline
   Can nickname lights & Thu 12/10/15 \\ \hline
   Buttons to toggle lights individually & Thu 12/10/15 \\ \hline
   Sliders to change light intensity & Fri 12/11/15 \\ \hline
   Can put lights into groups & Mon 12/14/15 \\ \hline
   Displays list of groups & Tue 12/15/15 \\ \hline
   Can nickname groups & Wed 12/16/15 \\ \hline
   Groups can be nested & Wed 12/23/15 \\ \hline
   Can toggle lights/groups based on rules & Fri 1/1/16 \\ \hline
   
   \textbf{Rules} & \\ \hline
   
   Lights can be toggled manually, overriding any rules & Tue 12/15/15 \\ \hline
   Rules can be temporarily disabled & Wed 1/6/16 \\ \hline
   Lights can be toggled based on time of day & Tue 1/12/16 \\ \hline
   Lights can be toggled based on day of week & Thu 1/14/16 \\ \hline
   Lights can be toggled based on day of month & Thu 1/14/16 \\ \hline
   Lights can be toggled based on day of year & Thu 1/14/16 \\ \hline
   Lights can be toggled based on specific dates & Thu 1/14/16 \\ \hline
   Lights can be toggled based on sunrise/sunset times & Fri 1/22/16 \\ \hline
   Multiple rules per light/group & Fri 1/15/16 \\ \hline
   Lights can be toggled based on parent group & Tue 1/5/16 \\ \hline
   Rules can toggle early/late by random time & Tue 1/5/16 \\ \hline
   Lights can toggle early/late randomly within groups & Wed 1/6/16 \\ \hline
   Lights can gradually toggle over time & Thu 1/7/16 \\ \hline
\end{tabular}

\section{References}

Hardware:
\begin{itemize}
    \item ESP8266 Board: https://www.tindie.com/products/hbouzas/general-purpose-wifi-control-board-x4/
    \item TFTLCD Screen for Raspberry Pi: http://www.adafruit.com/products/1774
    \item Raspberry Pi 2: https://www.raspberrypi.org/products/raspberry-pi-2-model-b/
    \item 10A Relay Board: https://www.electronickits.com/4-channel-auto-roll-rf-relay-board-assembled/
\end{itemize}
Software:
\begin{itemize}
    \item Yocto Project: https://www.yoctoproject.org/
    \item Lua: http://www.lua.org/
    \item Flask: http://flask.pocoo.org/
    \item NGINX: https://www.nginx.com/resources/wiki/
\end{itemize}

\end{document}
